---
title: "Harry Potter_two_mode"
author: "Tom R. Leppard"
date: "2024-08-21"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```
```{r}
library(igraph)
```

This script is intended for learning how to work with two-mode network data. It uses some data I put together about Characters from the Harry Potter movies. 

Most of the info came from this site - https://harrypotter.fandom.com/wiki/Dumbledore%27s_Army
I.e. I googled "list of prefects at hogwarts" then deferred to that above wiki. Same for phoenix, death eaters etc. 

I then checked each person on google to see what house they were in - some are missing and NA because they are fake characters from the movies or the wiki page.

```{r}
hp <- read.csv(file.choose(),header=TRUE,row.names=1) ## select harry_potter_two_mode.csv

hp_mat <- as.matrix(hp)

head(hp_mat)

hp_aff <- graph_from_biadjacency_matrix(hp_mat)


plot(hp_aff)
```

Let's make the visualisation much clearer between the two types of nodes. 

I do this by changing the shape and the colour of each type of node. I set a vector with the colours and shapes I want
```{r}
shapes <- c("circle", "square")
colors <-c("green", "orange")
```

Then we can plot them based on these design parameters
```{r}
par(mar =c(5,0,2,0))
plot(hp_aff, vertex.color=colors[V(hp_aff)$type+1],
     vertex.shape=shapes[V(hp_aff)$type+1], vertex.label.cex = 0.5, vertex.size = 7, main = "Harry Potter", sub = "Characters Connected to Groups")
legend("topright", 
       legend = c("Individuals (circle)", "Groups (square)"), 
       fill = c("green", "orange"), 
       title = "Node Types")

```


Let's visualise different centrality measures on this two-mode network
```{r}
par(mar =c(0,0,0,0))
plot(hp_aff, vertex.color=colors[V(hp_aff)$type+1],
     vertex.shape=shapes[V(hp_aff)$type+1], vertex.size = betweenness(hp_aff)/100, vertex.label = NA)

plot(hp_aff, vertex.color=colors[V(hp_aff)$type+1],
     vertex.shape=shapes[V(hp_aff)$type+1], vertex.label = degree(hp_aff), vertex.label.cex = 0.75)

```

These are great, but do not quite capture the bipartite (two-mode) nature of the network. Igraph has a specific layout option that can help emphasise this. 
```{r}
par(mar =c(0,0,0,0))
plot(hp_aff, vertex.color=colors[V(hp_aff)$type+1],
     vertex.shape=shapes[V(hp_aff)$type+1], vertex.label = NA, layout = layout_as_bipartite(hp_aff))
```


If you prefer, you can make this network an edgelist instead of an adjacency matrix.
```{r}
hp_aff_edge <- as_edgelist(hp_aff)
colnames(hp_aff_edge) <- c("character", "group")
```